---
title: "실계 hw3"
author: "2019150418 통계학과 김나연"
date: '2021 5 15 '
output: word_document
---

# 6.3
```{r}
A=c(rep(0,8),rep(1,8))
B=rep(c(rep(0,4),rep(1,4)),time=2)
C=c(0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1)
cake=c(84,90,78,80,80,82,70,74,75,77,75,81,80,82,74,76)

A_f=as.factor(A)
B_f=as.factor(B)
C_f=as.factor(C)
```

## (2)
```{r}
tapply(cake,A_f,mean)
tapply(cake,B_f,mean)
tapply(cake,C_f,mean)
```

## (3)
```{r}
tapply(cake,A_f:B_f,mean)
tapply(cake,A_f:C_f,mean)
tapply(cake,B_f:C_f,mean)
```

## (4)
```{r}
tapply(cake,A_f,mean)-mean(cake)
tapply(cake,B_f,mean)-mean(cake)
tapply(cake,C_f,mean)-mean(cake)
```
### A의 주효과는 -2.25, B는 -2.75, C는 -5.25이다.

## (5)
### ##(10)을 참고하면 SSA는 20.25, SSB는 30.25, SSC는 110.25 임을 알 수 있다.

## (6)
```{r}
aov6.3=aov(cake~A_f*B_f*C_f)
model.tables(aov6.3,'mean')

AB=(78-77-76.5+83)/2
AC=(76.5-78.5-75.5+84)/2
BC=(73.5-81-78.5+81.5)/2
c(AB,AC,BC)
```
### AB의 상호작용효과는 3.75, AC는 3.25, BC는 -2.25이다.

## (7)
### ##(10)을 참고하면 SSAB는 56.25, SSAC는 42.25, SSBC는 20.25임을 알 수 있다. 

## (8)
```{r}
model.tables(aov6.3,'mean')

ABC=(79+75-72-78-87-81+81+76)/8
ABC
```
### ABC의 상호작용효과는 -0.875이다.

## (9)
### ##(10)의 분산분석표를 참고하면 SSABC=12.25

## (10)
```{r}
aov6.3=aov(cake~A_f*B_f*C_f)
summary(aov6.3)
```
### H0: 요인 A는 효과가 없다. / H1: 요인 A는 효과가 있다. -> 검정통계량 F=3, Pvalue=0.12>0.05 => 귀무가설 기각 X, 즉 요인 A(신맛을 내는 산)는 효과가 없다.

H0: 요인 B는 효과가 없다. / H1: 요인 B는 효과가 있다. -> 검정통계량 F=4.481, Pvalue=0.067>0.05 => 귀무가설 기각 X, 즉 요인 B(글리세롤)는 효과가 없다. 

H0: 요인 C는 효과가 없다. / H1: 요인 C는 효과가 있다. -> 검정통계량 F=16.33, Pvalue=0.0037<0.05 => 귀무가설 기각 대립가설 채택, 즉 요인 C(달걀분말)는 효과가 있다.

H0:요인 A와 B의 상호작용효과가 없다. / H1: 요인 A와 B의 상호작용효과가 있다. -> 검정통계량 F=8.33, Pvalue=0.0203<0.05 => 귀무가설 기각 대립가설 채택, 즉 요인 A(신맛을 내는 산)과 B(글리세롤)의 상호작용효과가 있다.
 
H0:요인 A와 C의 상호작용효과가 없다. / H1: 요인 A와 C의 상호작용효과가 있다. -> 검정통계량 F=6.2593, Pvalue=0.036<0.05 => 귀무가설 기각 대립가설 채택, 즉 요인  A(신맛을 내는 산)과 C(달걀분말)의 상호작용효과가 있다.
 
H0:요인 B와 C의 상호작용효과가 없다. / H1: 요인 B와 C의 상호작용효과가 있다. -> 검정통계량 F=3, Pvalue=0.1215>0.05 => 귀무가설 기각 X, 즉 요인 B(글리세롤)과 요인 C(달걀분말)의 상호작용효과가 없다.
 
 H0: 요인 A와 B와 C의 상호작용효과가 없다. / H1: 요인 A와 B와 C의 상호작용효과가 있다. -> 검정통계량 F=1.815, Pvalue=0.214>0.05 => 귀무가설 기각 X, 즉 요인 A와 B와 C의 상호작용효과가 없다.
 
## (11)
```{r}
aov6.3_adj=aov(cake~A_f+B_f+C_f+A_f*B_f+A_f*C_f)
summary(aov6.3_adj)
```


# 6.4
```{r}
glass=c(rep(1,9),rep(2,9),rep(3,9))
tem=rep(rep(c(100,125,150),each=3),3)
bulb=c(580,568,570,1090,1087,1085,1392,1380,1386,550,538,570,1070,1037,1025,1386,1328,1312,540,570,599,1045,1053,1066,900,904,880)

glass_f=as.factor(glass)
tem_f=as.factor(tem)
```

## (2)
```{r}
interaction.plot(glass_f,tem_f,response=bulb,xlab='유리 종류',ylab='온도별 전구의 밝기')
```

## (3)
```{r}
interaction.plot(tem_f,glass_f,response=bulb,xlab='온도',ylab='유리 종류별 전구의 밝기')
```

## (4)
```{r}
plot(bulb~glass_f,xlab='유리 종류',ylab='전구의 밝기')
```

## (5)
```{r}
plot(bulb~tem_f,xlab='온도',ylab='전구의 밝기')
```

## (6)
```{r}
tapply(bulb,glass_f,mean)
```

## (7)
```{r}
tapply(bulb,tem_f,mean)
```

## (8)
```{r}
tapply(bulb,glass_f:tem_f,mean)
```

## (9)
```{r}
aov6.4=aov(bulb~glass_f*tem_f)
summary(aov6.4)
```

## (10)
### H0: 유리 종류에 따라 밝기 차이가 없다. / H1: 유리 종류에 따라 밝기 차이가 있다. 로 가설을 설정하고 검정한다. 검정통계량 F=196.5이고 P value는 유의수준 0.05하에서 매우 유의한 값을 가지므로 귀무가설을 기각하고 대립가설을 채택한다. 따라서 유리 종류에 따라 밝기 차이가 존재한다고 할 수 있다. 

## (11)
### H0: 온도에 따라 밝기 차이가 없다. / H1: 온도에 따라 밝기 차이가 있다. 로 가설을 설정하고 검정한다. 검정통계량 F=2588.5이고 P value는 유의수준 0.05하에서 매우 유의한 값을 가지므로 귀무가설을 기각하고 대립가설을 채택한다. 따라서 온도에 따라 밝기 차이가 존재한다고 할 수 있다. 

## (12)
### H0: 유리 종류와 온도에 따른 상호작용효과가 없다. / H1: 유리 종류와 온도에 따른 상호작용효과가 있다. 로 가설을 설정하고 검정한다. 검정통계량 F=185이고 P value는 유의수준 0.05하에서 매우 유의한 값을 가지므로 귀무가설을 기각하고 대립가설을 채택한다. 따라서 유리 종류와 온도에 따른 상호작용효과가 존재한다고 할 수 있다. 

## (13)
```{r}
par(mfrow=c(2,2))
plot(aov6.4)
```
### 잔차가 대체로 0을 중심으로 일정하게 분포해있다. 그리고 normal q-qplot을 보면 y=x직선에 양 끝부분을 제외하고는 고르게 근접해 있으므로 정규분포를 따른다고 할 수 있다.

# 7.3
```{r}
A=c(rep(0,12),rep(1,12))
B=c(rep(0,6),rep(1,6),rep(0,6),rep(1,6))
C=rep(c(rep(0,3),rep(1,3)),time=4)
y=c(21,23,25,25,27,29,37,38,39,31,34,37,20,22,24,22,24,26,35,37,39,39,40,41)
q7_3=data.frame(A,B,C,y)
attach(q7_3)
```

## (2)
```{r}
tapply(y,A,mean) # 요인 A의 수준별 평균
tapply(y,B,mean) # 요인 B의 수준별 평균
tapply(y,C,mean) # 요인 C의 수준별 평균
tapply(y,A,sd) # 요인 A의 수준별 표준편차
tapply(y,B,sd) # 요인 B의 수준별 표준편차
tapply(y,C,sd) # 요인 C의 수준별 표준편차
```

## (3)
```{r}
par(mfrow=c(1,3))
interaction.plot(A,B,y,type='l')
interaction.plot(A,C,y,type='l')
interaction.plot(B,C,y,type='l')
```

## (4)
```{r}
(sum(q7_3$y[A==1])-sum(q7_3$y[A==0]))/12
```

## (5)
```{r}
(sum(q7_3$y[B==1])-sum(q7_3$y[B==0]))/12
```

## (6)
```{r}
(sum(q7_3$y[C==1])-sum(q7_3$y[C==0]))/12
```

## (7)
```{r}
A0B0C0=21+23+25
A0B1C0=37+38+39
A0B0C1=25+27+29
A0B1C1=31+34+37
A1B0C0=20+22+24
A1B0C1=22+24+26
A1B1C0=35+37+39
A1B1C1=39+40+41

(A1B1C0+A1B1C1+A0B0C0+A0B0C1-A1B0C0-A1B0C1-A0B1C0-A0B1C1)/12
```

## (8)
```{r}
(A0B0C0+A0B1C0+A1B0C1+A1B1C1-A1B0C0-A1B1C0-A0B0C1-A0B1C1)/12
```


## (9)
```{r}
(A0B0C0+A1B0C0+A0B1C1+A1B1C1-A0B1C0-A1B1C0-A0B0C1-A1B0C1)/12
```

## (10)
```{r}
(A1B1C1+A1B0C0+A0B1C0+A0B0C1-A0B0C0-A1B1C0-A1B0C1-A0B1C1)/12
```

## (11)
```{r}
L=aov(y~A*B*C)
summary(L)
```

## (12)
### 유의수준 5%하에서 주효과 B, 상호작용효과 AB,BC,ABC가 유의한 효과다. ( 가설, 검정통계량 F, F기각값에 대한 검정 등은 손코딩에 기재함)

## (13)
```{r}
L_p=aov(y~A+B+C+A:B+B:C+A:B:C)
summary(L_p)
```

# 7.6
```{r}
A=c(rep('A1',8),rep('A2',8))
B=c(rep(c(rep('B1',4),rep('B2',4)),time=2))
C=rep(c(rep('C1',2),rep('C2',2)),time=4)
y=c(1595,1578,1745,1689,1835,1823,1838,1614,1573,1592,2185,1685,1700,1815,1717,1814)
q7.6=data.frame(A,B,C,y)
attach(q7.6)
A=as.factor(A)
B=as.factor(B)
C=as.factor(C)
```

## (2)
```{r}
tapply(y,A,mean) # 요인 A에 대한 수준별 평균
tapply(y,A,sd) # 요인 A에 대한 수준별 표준편차
tapply(y,B,mean) # 요인 B에 대한 수준별 평균
tapply(y,B,sd) # 요인 B에 대한 수준별 표준편차
tapply(y,C,mean) # 요인 C에 대한 수준별 평균
tapply(y,C,sd) # 요인 C에 대한 수준별 표준편차
```

## (3)
```{r}
interaction.plot(A,B,y,type='l')
```

## (4)
```{r}
aov7.6=aov(y~A*B*C)
model.tables(aov7.6,type='mean')
k=c(1760.1-1714.6,1769.5-1705.2,1785.9-1688.9)
names(k)=c('주효과 A','주효과 B','주효과 C')
k

```

## (5)
```{r}
tapply(y,A:B:C,sum)
m=c((3173+3434-3658-3452-3165-3870+3515+3531)/8,(3173-3434+3658-3452-3165+3870-3515+3531)/8,(3173-3434-3658+3452+3165-3870-3515+3531)/8)
names(m)=c('상호작용효과 AB','상호작용효과 AC','상호작용효과 BC')
m
```

## (6)
```{r}
(-3173+3434+3658-3452+3165-3870-3515+3531)/8
```

## (7)
```{r}
summary(aov7.6)
```

## (8)
### 유의수준 0.05 하에서 어떠한 효과도 유의하지 않다. ( 가설, 검정통계량 F, F기각값에 대한 검정 등은 손코딩에 기재함)

## (9)
```{r}
model.tables(aov7.6,type='effects')
```

## (10)
### 오차항의 분산에 대한 추정값은 MSE이므로 20421이다.

# 7.14
```{r}
rep=c(rep(1,8),rep(2,8),rep(3,8),rep(4,8))
block=rep(c(rep(1,4),rep(2,4)),time=4)
A=c(0,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,1,0,1,0,0,1,1,0,0,1,1,1,0,1,0)
B=c(0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,1,1,1,0,1,0,0,1,0,1,0,0,1,1)
C=c(0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,1,0,1,0,0,1,1,0,1,0,1)
y=c(2,3,-7,-2,0,1,0,-1,-3,8,-6,0,1,1,-6,2,-2,-6,-1,-4,9,-3,0,-4,-5,4,0,-2,0,-3,2,-1)

q7_14=data.frame(rep,block,A,B,C,y)
attach(q7_14)
rep_f=as.factor(rep)
block_f=as.factor(block)
A_f=as.factor(A)
B_f=as.factor(B)
C_f=as.factor(C)

L=aov(y~rep_f+rep_f:block_f+A_f*B_f*C_f)
anova(L)
```
### H0:B0=B1=0/H1:NOT H0. F_B=11.2671>F_1.17(0.05)=0.65=> H0기각, H0:C0=C1=0/H1:NOT H0. F_C=8.5056>F_1.17(0.05)=0.65=> H0기각. alpha=0.05 하에서 주효과 B와 C가 유의한 효과다. ( 가설, 검정통계량 F, F기각값에 대한 검정 등은 손코딩에 기재함)
