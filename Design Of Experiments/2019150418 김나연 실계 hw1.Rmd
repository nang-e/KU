---
title: "실험계획법 hw1"
author: "2019150418 통계학과 김나연"
date: '2021 3 22 '
output: word_document
---
# 2.1 
```{r}
com=c(5,10,11,11,4,5,13,19,12,9)
```

## (1)
```{r}
com_mean=mean(com)
com_var=var(com)
com_sd=sd(com)
c(com_mean,com_var,com_sd)
```
## (2)
### H0: mu>10 ; H1: mu<=10

## (3)
```{r}
t.test(com,mu=10,alternative='less')
```
### 검정통계량은 -0.070148, pvalue가 0.4728로 유의수준 0.05하에서 귀무가설을 기각하고 대립가설을 받아들인다. 따라서 평균 수리시간은 10시간보다 적게 걸린다고 말할 수 있다.

## (4)
```{r}
t.test(com)
```
### 평균 수리시간에 대한 95% 신뢰구간은 (6.6752,13.1248)이다.

## (5)
### H0: sigma^2=5 ; H1: sigma^2은 5가 아니다.

## (6)
```{r}
com_6=(length(com)-1)*com_var/5
com_6
pchisq(com_6,df=9,lower.tail=var(com)<5)*2

```

## (7)
```{r}
Q2_1_7=c((length(com)-1)*var(com)/qchisq(0.025,df=9,lower.tail=F),(length(com)-1)*var(com)/qchisq(0.975,df=9,lower.tai=F))
Q2_1_7
```
### 95% 신뢰구간은 (9.6148,67.7310)이다.

## (8)
```{r}
qqnorm(com)
qqline(com)
```
### qqplot을 보면 qqline에서 데이터들이 많이 벗어나지 않은 것으로 보인다. 따라서 정규분포를 따를 것 같다. 
## (9)
```{r}
shapiro.test(com)
```
### 귀무가설은 정규분포를 따른다, 대립가설은 정규분포를 따르지 않는다이다. 검정통계량 W=0.92736이며 Pvalue는 0.4224로 유의수준 하에서 유의하지 않으므로 귀무가설을 기각할 수 없다. 따라서 이 데이터는 정규분포를 따른다. 

# 2.2
```{r}
macha=c(501,502,495,498,499,506)
machb=c(508,510,503,504,500,504,505,512)
```

## (1)
### H0: sigmaA^2/sigmaB^2=1 ; H1 : sigmaA^2/sigmaB^2 is not 1

## (2)
```{r}
var.test(macha,machb)
```
### pvalue가 0.9461로 유의수준 0.05 하에서 유의하지 않은 결과가 나왔으므로 귀무가설을 기각하지 못한다. 따라서 두 기계의 분산이 동일하다고 할 수 있다.

## (3) 
### (2)의 결과에 의해 알 수 있다싶이 95% 신뢰구간은 (0.1714,6.2064)이다.

## (4)
```{r}
t.test(macha,machb,var.equal=T)
```
### 귀무가설: 두 기계의 평균은 동일하다. 대립가설: 두 기계의 평균은 다르다 / pvalue가 0.0205로 유의수준 0.05하에서 유의한 값을 지니기때문에 귀무가설을 기각하고 대립가설을 받아들일 수 있다. 따라서 두 기계의 평균 우유랑은 다르다고 할 수 있다. 

# 2.3
```{r}
a=c(65,81,57,66,75,70)
b=c(78,79,82,74,79,84)
```
## (1)
```{r}
a_m=mean(a)
b_m=mean(b)
a_var=var(a)
b_var=var(b)
a_sd=sd(a)
b_sd=sd(b)
q2_3_1=c(a_m,b_m,a_var,b_var,a_sd,b_sd)
names(q2_3_1)=c('a평균','b평균','a분산','b분산','a표준편차','b표준편차')
q2_3_1
```
## (2)
```{r}
t.test(a,b,var.equal=T)
```
### Pvalue가 0.01888로 유의수준인 0.05보다 작으므로 유의하다. 따라서 귀무가설(물질A와 B의 평균 연소시간은 같다)을 기각하고 대립가설(물질A와 B의 평균 연소시간은 다르다)을 채택한다. 따라서 두 물질의 평균 연소시간은 다르다.

## (3)
```{r}
t.test(a,b,var.equal=F)
```
### Pvalue가 0.02807로 유의수준인 0.05보다 작으므로 유의하다. 따라서 귀무가설(물질A와 B의 평균 연소시간은 같다)을 기각하고 대립가설(물질A와 B의 평균 연소시간은 다르다)을 채택한다. 따라서 두 물질의 평균 연소시간은 다르다.
## (4)
```{r}
var.test(a,b)
```
### Pvalue가 0.0738로 유의수준 0.05보다 크므로 유의하지 않다. 그러므로 대립가설(물질끼리 분산이 다르다)을 채택하지 못하고 귀무가설(물질끼리 분산이 동일하다)을 기각할 수 없다. 따라서 물질끼리 분산은 동일하다고 결론내릴 수 있다.  

# 2.5
## (1)
```{r}
before=c(55,60,70,75,66,78,80,83,88,73)
after=c(54,55,64,73,61,70,76,65,78,72)
d=before-after
d
```

## (2)
```{r}
d_m=mean(d)
d_var=var(d)
d_sd=sd(d)
Q2_5_2=c(d_m,d_var,d_sd)
names(Q2_5_2)=c('평균','분산','표준편차')
Q2_5_2
```
## (3)
```{r}
t.test(d,alternative = 'greater')
```
### H0: 약의 효과가 없다(모평균차이=0);H1:약의 효과가 있다(모평균차이>0)로 가설을 설정할 수 있다. 검정통계량 t는 3.7052이고 pvalue는 0.00244로 나온다. pvalue가 유의수준 0.05보다 작으므로 귀무가설을 기각하고 대립가설을 채택한다. 따라서 약의 효과가 존재, 즉 체중감소효과가 있다고 할 수 있다. 

# 3.2
## (3)
```{r}
N=27;k=3
trtmean=c(240,320,180)/9
contr3_2=c(1,-1,0)
L3_2=sum(contr3_2*trtmean)
mse=60
t3_2=L3_2/sqrt(mse*(1/9+1/9))
pt(t3_2,df=24)
```
### pvalue가 유의수준 0.05하에서 매우 유의한 값인 0.01로 나오므로 귀무가설(비료 A와 B는 차이가 없다)를 기각하고 대립가설(비료 A와 B는 차이가 있다)를 채택한다.

## (4)
```{r}
N=27;k=3
trtmean=c(240,320,180)/9
contr3_2=c(1,-2,1)
L3_2=sum(contr3_2*trtmean)
mse=60
t3_2=L3_2/sqrt(mse*(1/9+1/9))
pt(t3_2,df=24)
```
### pvalue가 유의수준 0.05하에서 매우 유의한 값이므로 귀무가설(비료 A와 C는 B와 차이가 없다)를 기각하고 대리바설(비료 A와 C는 B와 차이가 있다)를 채택한다.

# 3.3
```{r}
treat=c(rep('0',6),rep('25',6),rep('50',6),rep('75',6),rep('100',6))
temperature=c(55,55,57,54,54,56,60,61,60,60,60,60,70,72,73,68,77,77,72,72,72,70,68,60,65,66,60,64,65,65)
df3.3=data.frame(treat,temperature)
attach(df3.3)
```
## (1)
### Y_ij=mu+tau_i+epsilon_ij , i=1,...,5/j=1,...,6,epsilon_ij~i.i.d (0,sigma^2)

## (2)
```{r}
tapply(temperature,treat,mean)
tapply(temperature,treat,sd)
```
## (3)
```{r}
boxplot(temperature~treat)
```
## (4)
### H0: 온도(처리)에 따른 차이가 없다. 즉 mu1=mu2=mu3=mu4=mu5=m / H1: 온도(처리)에 따른 차이가 있다. 즉 NOT H0, 적어도 하나의 mu_i는 다른 값을 가진다.

## (5)
```{r}
aov3_3=aov(temperature~treat)
summary(aov3_3)
```

## (6)
### (4)의 가설에 대해 검정하기 위해 (5)의 분산분석표를 해석한다. MSt=293.13, MSe=8.29이고 검정통계량 F=MSt/MSe=35.35로 나왔다. pvalue가 유의수준 0.05보다 매우 작게 나왔으므로 귀무가설을 기각하고 대립가설을 채택한다. 즉 적어도 하나의 온도에서는 건전지가 활성화되기까지의 시간이 다르다.

## (7)
```{r}
library('agricolae')
lsd3_3=LSD.test(aov3_3,'treat',p.adj='none',main='temperature of different groups')
lsd3_3
```
### LSD 방법으로 유의수준 0.05하에서 검정시 모든 처리들 간에 평균 차이가 유의하다. 

## (8)
```{r}
hsd3_3=HSD.test(aov3_3,'treat')
hsd3_3
```
### Tukey의 방법으로 유의수준 0.05 하에서 검정시 온도 25도와 100도, 75도와 100도, 50도와 75도끼리만 유의하지 않은 차이를 보여서 평균의 차이가 존재하지 않고 나머지 다중비교들은 평균 차이가 유의하다. 

## (9)
```{r}
predict(aov3_3)
```

## (10)
```{r}
aov3_3$residuals
```

## (11)
```{r}
plot(aov3_3$residuals~aov3_3$fitted.values)
```
### fitted value에 상관없이 잔차가 무작위적으로 분포됐기 때문에 오차의 독립성이 충족된 것으로 보인다.

## (12)
```{r}
plot(aov3_3)
```
### 잔차에 대한 정규 qqplot을 보면 몇몇 잔차들은 경향성을 지니고 있는 것을 보이며, y=x그래프에서 벗어난 잔차들이 여럿 있기때문에 잔차가 정규성을 따르지 않는다고 보인다. 

# 3.6
```{r}
torsion=c(83,85,84,85,85,86,87,86,87,87,88,88,89,90,89,90,90,91,90,92,93)
angle=c(rep('67',2),rep('71',5),rep('75',7),rep('79',4),rep('83',3))
df3.6=data.frame(angle,torsion)
attach(df3.6)
```

## (1)
## (2)
```{r}
tapply(torsion,angle,mean)
tapply(torsion,angle,sd)
```
## (3)
```{r}
boxplot(torsion~angle)
```

## (4)
### H0: 각도에 따른 탄성력의 차이는 없다. 즉 mu1=mu2=mu3=mu4=mu5=mu이다. / H1: NOT H0 즉 적어도 하나라도 각도에 따른 탄성력의 차이는 있다.

## (5)
```{r}
aov3_6=aov(torsion~angle)
summary(aov3_6)
```
## (6)
### (5)의 분산분석표에 따르면 pvalue가 유의수준 0.05 하에서 매우 유의한 값이므로 H0을 기각하고 H1을 채택한다.

## (7)
```{r}
lsd3_3=LSD.test(aov3_6,'angle')
lsd3_3
```
## (8)
```{r}
hsd3_3=HSD.test(aov3_6,'angle')
hsd3_3
```
## (9)
```{r}
library(DescTools)
ScheffeTest(aov3_6)
```

## (10)
```{r}
aov3_6$residuals
```

## (11)
```{r}
plot(aov3_6)
```
### 정규 QQ plot을 보면 대체로 직선에 정규화된 잔차들이 밀집돼있는 것을 보아 정규성을 따를 것 같다. 또한 잔차간에 일정한 패턴이 없는 것을 보아 등분산성 또한 만족할 것 같다. fitted value에 상관없이 residual이 무작위적으로 분포됐기 때문에 오차의 독립성이 충족된 것으로 보인다.

# 3.7
## (1),(2),(3),(5) 손코딩
## (4)
```{r}
N=30;k=5
trtmean=c(120,600,720,240,420)/6
contr3_7=c(4,-1,-1,-1,-1)
L3_7=sum(contr3_7*trtmean)
mse=60
t3_7=L3_7/sqrt(mse*(1/6+1/6))
pt(t3_7,df=25)

```
### pvalue가 유의수준 0.05하에서 매우 유의한 값이므로 귀무가설(교수법1과 나머지 4개의 교수법과 성취도 평균에 차이가 없다)를 기각하고 대립가설(차이가 있다)를 채택한다.

