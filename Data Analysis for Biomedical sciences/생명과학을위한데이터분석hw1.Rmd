---
title: '생명과학을 위한 데이터분석 hw1'
author: "2019150418 통계학과 김나연"
date: '2021 3 24 '
output: word_document
---

# 2.2
```{r}
cellA=c(9.0,9.4,4.7,4.8,8.9,4.9,8.4,5.9,6.3,5.7,5.0,3.5,7.8,10.4,8.0,8.0,8.6,7.0,6.8,7.1,5.7,7.6,6.2,7.1,7.4,8.7,4.9,7.4,6.4,7.1,6.3,8.8,8.8,5.2,7.1,5.3,4.7,8.4,6.4,8.3)
cellB=c(12.6,14.6,16.2,23.9,23.3,17.1,20.0,21.0,19.1,19.4,16.7,15.9,15.8,16.0,17.9,13.4,19.1,16.6,18.9,18.7,20.0,17.8,13.9,22.1,13.9,18.3,22.8,13.0,17.9,15.2,17.7,15.1,16.9,16.4,22.8,19.4,19.6,18.4,18.2,20.7)
```
## (1)
```{r}
var.test(cellA,cellB)
t.test(cellA,cellB,var.equal=F,alternative = 'less')
```

### 우선 두 집단이 등분산성을 가질지 확인해봐야 한다. 따라서 H0: 림프구세포와 종양세포의 분산은 같다. H1: 림프구세포와 종양세포의 분산은 다르다 로 가설을 설정하고 등분산성 검정을 실시한다. 그 결과 유의수준 0.05 하에서 Pvalue가 0.0003정도로 매우 작게 나왔으므로 유의하다. 따라서 귀무가설을 기각하고 대립가설을 채택하여 두 세포의 분산은 다르다고 볼 수 있다. 이제 t검정을 실시해야하는데, 두 분산이 다르므로 t.test에서 var.equal=F를 옵션으로 걸어줘야 한다. 귀무가설은 림프구세포의 평균 크기가 종양세포의 평균 크기와 같다로 두고, 대립가설은 림프구세포의 평균 크기가 종양세포의 평균 크기보다 작다라고 가설을 설정한다. t.test 결과 5% 유의수준 하에서 pvalue가 매우 유의하게 나왔으므로 대립가설을 채택한다. 즉, 림프구세포의 평균 크기가 종양세포의 평균 크기보다 작다고 볼 수 있다.  

## (2)
### 림프구세포와 종양세포가 각각 정규분포를 따른다는 가정이 필요하다.

# 2.5
```{r}
library(dplyr)
group=c(rep('저',12),rep('중',12),rep('고',12))
srrs=c(22.2,97.8,29.1,37.0,35.8,44.2,82.0,56.0,9.3,19.9,39.5,12.8,15.1,23.2,10.5,13.9,9.7,19.0,19.8,9.1,30.1,15.5,10.3,11.0,10.2,11.3,11.4,5.3,14.5,11.0,13.6,33.4,25.0,27.0,36.3,17.7)
dsbio2_5=data.frame(group,srrs)
```
## (1)
### H0: 각 집단(저,중,고)의 평균 NK세포활동 수치가 같다. / H1: 적어도 하나의 집단의 평균 NK세포활동 수치가 같지 않다. (not H1)

## (2)
```{r}
summary(aov(dsbio2_5$srrs~dsbio2_5$group))
```

## (3)
### 우선 각집단의 정규성,독립성,등분산성은 가정하고 분석을 진행하겠다. (2)의 결과를 보면 pvalue가 5% 유의수준 하에서 매우 유의한 결과가 나왔으므로 세 집단의 NK세포활동 수치에 차이가 없다는 귀무가설을 기각하고 적어도 한 집단의 NK세포활동 수치는 차이가 있다는 대립가설을 채택한다. 

# 2.7
```{r}
eat=c(rep(1,5),rep(2,5),rep(3,5),rep(4,5))
exercise=c(rep(c('A','B','C','D','E'),4))
eat_f=factor(eat)
weight=c(7.0,9.9,8.5,5.1,10.3,5.3,5.7,4.7,3.5,7.7,4.9,7.6,5.5,2.8,8.4,8.8,8.9,8.1,3.3,9.1)
```

## (1)
```{r}
aov2.7=aov(weight~eat_f+exercise)
summary(aov2.7)
```

### 분산분석을 진행하기 전에 각집단간 등분산성,독립성,정규성은 가정한다. 아노바 결과의 summary를 보면 식이요법(eat)에 따라 체중 감량에 차이가 있다는 것을 알 수 있다. pvalue가 0.0007으로 유의수준 0.05 하에서 유의한 값이기 때문에 귀무가설(식이요법에 따라 감소된 체중이 차이가 없다)을 기각하고 대립가설(식이요법에 따라 감소된 체중이 차이가 있다)를 채택한다. 따라서 7-(1)의 답은 '차이가 있다.'.

## (2)
### 위의 분산분석 결과를 보면 운동방법(exercise)에 따라 체중 감량에 차이가 있다는 것을 알 수 있다. pvalue가 5% 유의수준 하에서 유의한 값이 나왔기 때문에 귀무가설(운동방법에 따른 체중 감량에 차이가 없다)을 기각하고 대립가설(운동방법에 따른 체중 감량에 차이가 있다)을 채택한다. 따라서 7-(2)의 답은 '차이가 있다.'.

## (3)
```{r}
library(DescTools)
ScheffeTest(aov2.7)
```
### 각각의 방법에 따라 차이가 있는지 확인하기 위해 사후분석을 진행했다. SCHEFFE의 방법을 이용하여 다중 비교를 한 결과, 식이요법의 경우에는 1번 식이요법과 2번 식이요법에 차이가 있는 것으로 보인다. 그리고 운동방법은 A와 D, B와 D, C와 D, D와 E 방법 간에 차이가 있는 것으로 보인다. 모든 비교는 5% 유의수준 하에서 비교했으며 귀무가설은 각 방법에 따라 차이가 없다이고 대립가설은 각 방법에 따라 차이가 있다이다. 

# 2.9
```{r}
count=c(25,28,22,28,32,30,25,35,30,18,23,19,16,24,20,14,16,15,17,24,19,18,22,20,10,8,12)
age=c(rep('low',3),rep('middle',3),rep('high',3),rep('low',3),rep('middle',3),rep('high',3),rep('low',3),rep('middle',3),rep('high',3))
usage=c(rep('never',9),rep('often',9),rep('every',9))
dsbio2_9=data.frame(age,usage,count)
dsbio2_9
```
```{r}
shapiro.test(dsbio2_9$count[age=='low'])
shapiro.test(dsbio2_9$count[age=='middle'])
shapiro.test(dsbio2_9$count[age=='high'])
shapiro.test(dsbio2_9$count[usage=='never'])
shapiro.test(dsbio2_9$count[usage=='often'])
shapiro.test(dsbio2_9$count[usage=='every'])

library(car)
leveneTest(dsbio2_9$count,dsbio2_9$age)
leveneTest(dsbio2_9$count,dsbio2_9$usage)

```
### 각 집단간 독립성을 가정하고, 정규성과 등분산성을 만족하는 것을 알 수 있다. 
## (1) 
### Y_ijk=mu+a_i+b_j+ab_ij+e_ijk

## (2) 
```{r}
aov2_9=aov(dsbio2_9$count~dsbio2_9$age*dsbio2_9$usage)
summary(aov2_9)
```

## (3)
### 나이가 감정적 성숙점수에 영향을 미치는지 알아보려면 H0: 나이는 감정적 성숙점수에 영향을 미치지 않는다 H1: 나이는 감정적 성숙점수에 영향을 미친다 를 가설로 설정한다. 위의 분산분석표를 보면 나이의 pvalue는 0.0083으로 5% 유의수준 하에서 매우 유의한 값을 가지므로 귀무가설을 기각하고 대립가설을 채택하여 나이는 감정적 성숙점수에 영향을 미친다는 것을 알 수 있다. 또한 마리화나 사용여부가 감정적 성숙점수에 영향을 미치는지 알아보려면 H0: 마리화나 사용여부는 감정적 성숙점수에 영향을 미치지 않는다 H1: 마리화나 사용여부는 감정적 성숙점수에 영향을 미친다 를 가설로 설정한다. 위의 분산분석표를 보면 사용여부의 pvalue는 0.001보다도 작으므로 5% 유의수준 하에서 매우 유의한 값을 가진다. 따라서 귀무가설을 기각하고 대립가설을 채택하여 마리화나 사용여부는 감정적 성숙점수에 영향을 미친다는 것을 알 수 있다. 마지막으로 나이와 마리화나 사용여부간의 유의한 교호작용효과가 있는지 알아보기 위해 H0: 교호작용효과가 없다 H1: 교호작용효과가 있다로 가설을 설정한다. pvalue가 0.0071로 매우 유의한 값을 가지므로 나이와 사용여부 간 교호작용효과가 존재한다는 것을 알 수 있다.



# 3.1
```{r}
pro3_1=matrix(c(5,8,21,82),byrow=F,nrow=2)
colnames(pro3_1)=c('우울유','우울무')
rownames(pro3_1)=c('위험유','위험무')
pro3_1
```

## (1)
```{r}
RR={pro3_1[1,1]/sum(pro3_1[1,])}/{pro3_1[2,1]/sum(pro3_1[2,])}
OR={pro3_1[1,1]*pro3_1[2,2]}/{pro3_1[1,2]*pro3_1[2,1]}
c(RR,OR)
```
## (2)
```{r}
# 상대위험률(RR)의 95% 신뢰구간
v1={1-pro3_1[1,1]/sum(pro3_1[1,])}/pro3_1[1,1]+{1-pro3_1[2,1]/sum(pro3_1[2,])}/pro3_1[2,1]
c(RR*exp(-qnorm(0.975)*sqrt(v1)),RR*exp(qnorm(0.975)*sqrt(v1)))

# 오즈비(OR)의 95% 신뢰구간
v2=1/pro3_1[1,1]+1/pro3_1[1,2]+1/pro3_1[2,1]+1/pro3_1[2,2]
c(OR*exp(-qnorm(0.975)*sqrt(v2)),OR*exp(qnorm(0.975)*sqrt(v2)))
```

## (3)
### 상대위험률이 1보다 크므로 위험요인이 있을 때, 위험요인이 없을 때보다 산후우울증이 많이 걸린다는 것을 알 수 있다. 그리고 오즈비를 보면, 산후 우울증이 있는 집단에서 위험요인이 있는 사람들이 산후 우울증이 없는 집단에서 위험요인이 있는 사람들의 약 2.44배임을 알 수 있다. 

# 3.3
```{r}
pro3_3=matrix(c(49,24,2,12,9,29),nrow=3,byrow=F)
addmargins(pro3_3)
chisq.test(pro3_3)
```
## 카이스퀘어 검정의 pvalue가 매우 작으므로 세 집단 간 재발률이 같다는 귀무가설을 기각하게 된다. 즉, 세 집단간 재발률은 다르다. 

# 3.6
```{r}
pro3_6=matrix(c(1,8,5,2),nrow=2,byrow=F)
colnames(pro3_6)=c('안경착용','안경미착용')
rownames(pro3_6)=c('비행청소년','일반청소년')
addmargins(pro3_6)
fisher.test(pro3_6)
```
### 피셔의 정확 검정법을 시행한 결과, pvalue가 0.035로 유의수준 0.05보다 작으므로 비행청소년과 일반청소년의 안경을 쓴 비율이 같다는 귀무가설을 기각한다. 따라서 두 집단(일반청소년, 비행청소년)이 안경을 쓴 비율은 같지 않다.

# 3.7
```{r}
pro3_7=matrix(c(794,86,150,570),byrow=F,nrow=2)
colnames(pro3_7)=c('두번째찬성','두번째반대')
rownames(pro3_7)=c('첫번째찬성','첫번째반대')
addmargins(pro3_7)

mcnemar.test(pro3_7,correct=F) # 연속성 수정 안한 경우
mcnemar.test(pro3_7) # 연소성 수정 한 경우
```
### 동일한 1600명에 대해 첫번째 투표, 두번째 투표를 진행하여 찬반을 조사한 것이기 때문에 카이제곱검정이 아닌 맥니마 검정을 시행한다. 귀무가설은 첫번째 투표에서의 반응률과 두번째 투표에서의 반응률이 같다이고 대립가설은 반응률이 같지 않다이다. R을 통해 맥니마 검정을 시행한 결과 연속성 보정을 한 경우와 안 한 경우 둘 다 P-값이 매우 작아 유의하다. 그러므로 귀무가설을 기각하고 대립가설을 채택한다. 즉, 첫 번째 투표와 두 번째 투표에서 찬성확률이 동일하지 않다.

# 3.8
```{r}
pro3_8=array(c(2,0,21,10,2,0,40,18,6,0,33,10,17,0,16,4),dim=c(2,2,4),dimnames=list(gender=c('M','F'),death=c('Y','N'),severity=c('심각하지 않음','약간 심각','심각','매우 심각')))
pro3_8
mantelhaen.test(pro3_8,correct=F) #질병의 심각도로 층변수로 제어한 경우

pro3_8.2=margin.table(pro3_8,margin=c(1,2))
pro3_8.2
chisq.test(pro3_8.2,correct=F) # 질병의 심각도를 층변수로 제어하지 않은 경우
```
### H0: 성별과 생존 상태는 연관이 없다. H1: 성별과 생존 상태는 연관이 있다 로 가설을 설정하고 코크란멘텔헨젤 검정을 실시한다. 성별과 생존 상태의 연관성에 대해 알고 싶은 것이기 때문에 우선 질병의 심각도를 층변수로 제어하고 검정을 실시해본 결과, 5% 유의수준 하에서 유의한 값이 나왔기 때문에 귀무가설을 기각한다. 질병의 심각도를 층변수로 제어하지 않은 경우에도 P값이 0.0018로 매우 작게 나왔으므로 귀무가설을 기각하고 대립가설을 채택한다. 즉 성별과 생존 상태는 연관이 있음을 알 수 있다.

# 3.9
```{r}
pro3_9=matrix(c(302,179,80,372),nrow=2)
rownames(pro3_9)=c('양성','음성')
colnames(pro3_9)=c('질병유','질병무')
pro3_9

```
## (1)
```{r}
sensi=pro3_9[1,1]/sum(pro3_9[,1])
speci=pro3_9[2,2]/sum(pro3_9[,2])
c(sensi,speci)
```
### 민감도는 0.6279, 특이도는 0.8230으로 나온다.

## (2)
```{r}
D=0.1
posi=sensi*D/{sensi*D+(1-speci)*(1-D)}
nega=speci*(1-D)/{(1-sensi)*D+speci*(1-D)}
c(posi,nega)
```
### 양성예측도는 0.2827, 음성예측도는 0.9521로 나온다.
